{{ 'component-card.css' | asset_url | stylesheet_tag }}

<style>
  .seller-page-hero {
    background: linear-gradient(135deg, #fff8e7 0%, #fef3d8 50%, #fff8e7 100%);
    padding: 48px 0;
    margin-bottom: 0;
    text-align: center;
  }

  .seller-page-hero__subtitle {
    font-size: 13px;
    text-transform: uppercase;
    letter-spacing: 2px;
    color: #8B4513;
    margin-bottom: 12px;
  }

  .seller-page-hero__title {
    font-size: 36px;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0 0 16px 0;
  }

  .seller-page-hero__description {
    font-size: 16px;
    color: #555;
    max-width: 600px;
    margin: 0 auto;
    line-height: 1.6;
  }

  .seller-carousels {
    padding: 40px 0;
    background: #f8f7f5;
  }

  /* Search and Filter Bar */
  .seller-search-bar {
    background: #fff;
    padding: 20px;
    border-radius: 12px;
    margin-bottom: 24px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    display: flex;
    gap: 16px;
    flex-wrap: wrap;
    align-items: center;
  }

  .seller-search-bar__input-wrapper {
    flex: 1;
    min-width: 250px;
    position: relative;
  }

  .seller-search-bar__input {
    width: 100%;
    padding: 12px 16px 12px 44px;
    border: 1px solid #ddd;
    border-radius: 8px;
    font-size: 15px;
    outline: none;
  }

  .seller-search-bar__input:focus {
    border-color: #8B4513;
  }

  .seller-search-bar__icon {
    position: absolute;
    left: 14px;
    top: 50%;
    transform: translateY(-50%);
    color: #888;
  }

  .seller-search-bar__filters {
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
  }

  .seller-search-bar__filter {
    padding: 10px 16px;
    border: 1px solid #ddd;
    border-radius: 8px;
    background: #fff;
    font-size: 14px;
    cursor: pointer;
    color: #333;
  }

  .seller-search-bar__filter:hover {
    border-color: #8B4513;
  }

  .seller-search-bar__filter.active {
    background: #8B4513;
    color: white;
    border-color: #8B4513;
  }

  .seller-carousel {
    background: #fff;
    border-radius: 12px;
    padding: 24px 28px;
    margin-bottom: 24px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .seller-carousel__header {
    margin-bottom: 20px;
  }

  .seller-carousel__title {
    font-size: 20px;
    font-weight: 600;
    color: #8B4513;
    margin: 0 0 6px 0;
  }

  .seller-carousel__subtitle {
    font-size: 14px;
    color: #666;
    margin: 0;
  }

  .seller-carousel__sellers {
    display: flex;
    gap: 20px;
    overflow-x: auto;
    scroll-behavior: smooth;
    padding-bottom: 8px;
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .seller-carousel__sellers::-webkit-scrollbar {
    display: none;
  }

  .seller-card {
    flex: 0 0 280px;
    min-width: 280px;
    background: linear-gradient(145deg, #fffaf5 0%, #fff8f0 100%);
    border-radius: 12px;
    box-shadow: 0 2px 12px rgba(139, 69, 19, 0.1);
    border: 1px solid rgba(139, 69, 19, 0.08);
    overflow: hidden;
    text-decoration: none;
    color: inherit;
    transition: transform 0.2s, box-shadow 0.2s, border-color 0.2s;
  }

  .seller-card:hover {
    transform: translateY(-4px);
    box-shadow: 0 8px 24px rgba(139, 69, 19, 0.15);
    border-color: rgba(139, 69, 19, 0.2);
  }

  .seller-card__banner {
    height: 80px;
    background: linear-gradient(135deg, #FF9933 0%, #FFB366 100%);
  }

  .seller-card__banner--education {
    background: linear-gradient(135deg, #4A90A4 0%, #6BB3C9 100%);
  }

  .seller-card__banner--home {
    background: linear-gradient(135deg, #6B8E23 0%, #9ACD32 100%);
  }

  .seller-card__banner--food {
    background: linear-gradient(135deg, #D2691E 0%, #F4A460 100%);
  }

  .seller-card__banner--services {
    background: linear-gradient(135deg, #8B4513 0%, #A0522D 100%);
  }

  .seller-card__content {
    padding: 20px;
    text-align: center;
    margin-top: -30px;
  }

  .seller-card__avatar {
    width: 60px;
    height: 60px;
    background: #fff;
    border-radius: 50%;
    margin: 0 auto 12px;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    font-size: 24px;
  }

  .seller-card__name {
    font-size: 16px;
    font-weight: 600;
    color: #1a1a1a;
    margin: 0 0 4px 0;
  }

  .seller-card__owner {
    font-size: 13px;
    color: #888;
    margin: 0 0 10px 0;
  }

  .seller-card__description {
    font-size: 13px;
    color: #666;
    margin: 0 0 15px 0;
    line-height: 1.4;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }

  .seller-card__products {
    font-size: 12px;
    color: #8B4513;
    font-weight: 500;
    margin-bottom: 12px;
  }

  .seller-card__view-btn {
    display: inline-block;
    padding: 8px 20px;
    background: #FF9933;
    color: white;
    font-size: 12px;
    font-weight: 600;
    border-radius: 20px;
    text-decoration: none;
    transition: background 0.2s;
  }

  .seller-card:hover .seller-card__view-btn {
    background: #e6852e;
  }

  .seller-carousel__wrapper {
    position: relative;
  }

  .seller-carousel__nav {
    position: absolute;
    right: 0;
    top: 50%;
    transform: translateY(-50%);
    width: 36px;
    height: 36px;
    background: #fff;
    border: 1px solid #ddd;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    z-index: 2;
  }

  .seller-carousel__nav:hover {
    background: #f5f5f5;
  }

  .seller-carousel__nav svg {
    width: 16px;
    height: 16px;
  }

  .seller-cta {
    text-align: center;
    margin-top: 20px;
    padding: 30px;
    background: #fff;
    border-radius: 12px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.05);
  }

  .seller-cta__title {
    color: #8B4513;
    font-size: 20px;
    margin: 0 0 10px 0;
  }

  .seller-cta__text {
    color: #666;
    margin: 0 0 20px 0;
  }

  .seller-cta__button {
    display: inline-block;
    padding: 12px 28px;
    background: #FF9933;
    color: white;
    text-decoration: none;
    border-radius: 6px;
    font-weight: 600;
  }

  .seller-cta__button:hover {
    background: #e6852e;
  }

  @media (max-width: 749px) {
    .seller-carousel {
      padding: 16px 20px;
      margin: 0 -15px 16px -15px;
      border-radius: 0;
    }

    .seller-card {
      flex: 0 0 240px;
      min-width: 240px;
    }

    .seller-page-hero__title {
      font-size: 28px;
    }
  }
</style>

<!-- Hero Section -->
<div class="seller-page-hero">
  <div class="page-width">
    <p class="seller-page-hero__subtitle">Seva Sethu Marketplace</p>
    <h1 class="seller-page-hero__title">{{ section.settings.heading }}</h1>
    <p class="seller-page-hero__description">{{ section.settings.description }}</p>
  </div>
</div>

<div class="seller-carousels page-width">

  <!-- Search and Filter Bar -->
  <div class="seller-search-bar">
    <div class="seller-search-bar__input-wrapper">
      <svg class="seller-search-bar__icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="11" cy="11" r="8"/>
        <path d="M21 21l-4.35-4.35"/>
      </svg>
      <input type="text" class="seller-search-bar__input" id="sellerSearch" placeholder="Search sellers..." onkeyup="filterSellers()">
    </div>
    <div class="seller-search-bar__filters">
      <button class="seller-search-bar__filter active" onclick="filterBySellerCategory('all', this)">All</button>
      {% for collection in collections %}
        {% if collection.all_products_count > 0 and collection.handle != 'frontpage' and collection.handle != 'all' %}
          <button class="seller-search-bar__filter" onclick="filterBySellerCategory('{{ collection.handle }}', this)">{{ collection.title }}</button>
        {% endif %}
      {% endfor %}
    </div>
  </div>

  {% comment %} Education & Courses Sellers {% endcomment %}
  {% assign education_collection = collections['education-courses'] %}
  {% if education_collection and education_collection.all_products_count > 0 %}
    {% assign education_vendors = "" %}
    {% for product in education_collection.products %}
      {% unless education_vendors contains product.vendor %}
        {% if education_vendors != "" %}
          {% assign education_vendors = education_vendors | append: "||" %}
        {% endif %}
        {% assign education_vendors = education_vendors | append: product.vendor %}
      {% endunless %}
    {% endfor %}
    {% assign education_vendor_list = education_vendors | split: "||" %}

    {% if education_vendor_list.size > 0 %}
    <div class="seller-carousel" data-category="education-courses">
      <div class="seller-carousel__header">
        <h3 class="seller-carousel__title">Education & Courses</h3>
        <p class="seller-carousel__subtitle">Learn from our community educators and mentors</p>
      </div>
      <div class="seller-carousel__wrapper">
        <div class="seller-carousel__sellers" id="carousel-education">
          {% for vendor in education_vendor_list %}
            {% assign vendor_products = education_collection.products | where: "vendor", vendor %}
            <div class="seller-card">
              <div class="seller-card__banner seller-card__banner--education"></div>
              <div class="seller-card__content">
                <div class="seller-card__avatar">üéì</div>
                <h4 class="seller-card__name">{{ vendor }}</h4>
                <p class="seller-card__description">
                  {% if vendor_products.first.description != blank %}
                    {{ vendor_products.first.description | strip_html | truncate: 80 }}
                  {% else %}
                    Quality education services for the community
                  {% endif %}
                </p>
                <p class="seller-card__products">{{ vendor_products.size }} product{% if vendor_products.size != 1 %}s{% endif %}</p>
                <a href="/collections/all?filter.p.vendor={{ vendor | url_encode }}" class="seller-card__view-btn">View Products</a>
              </div>
            </div>
          {% endfor %}
        </div>
        {% if education_vendor_list.size > 3 %}
        <button class="seller-carousel__nav" onclick="scrollSellerCarousel('carousel-education')" aria-label="Next">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 18l6-6-6-6"/>
          </svg>
        </button>
        {% endif %}
      </div>
    </div>
    {% endif %}
  {% endif %}

  {% comment %} Home & Garden Sellers {% endcomment %}
  {% assign home_collection = collections['home-garden'] %}
  {% if home_collection and home_collection.all_products_count > 0 %}
    {% assign home_vendors = "" %}
    {% for product in home_collection.products %}
      {% unless home_vendors contains product.vendor %}
        {% if home_vendors != "" %}
          {% assign home_vendors = home_vendors | append: "||" %}
        {% endif %}
        {% assign home_vendors = home_vendors | append: product.vendor %}
      {% endunless %}
    {% endfor %}
    {% assign home_vendor_list = home_vendors | split: "||" %}

    {% if home_vendor_list.size > 0 %}
    <div class="seller-carousel" data-category="home-garden">
      <div class="seller-carousel__header">
        <h3 class="seller-carousel__title">Home & Garden</h3>
        <p class="seller-carousel__subtitle">Eco-friendly products for your home and events</p>
      </div>
      <div class="seller-carousel__wrapper">
        <div class="seller-carousel__sellers" id="carousel-home">
          {% for vendor in home_vendor_list %}
            {% assign vendor_products = home_collection.products | where: "vendor", vendor %}
            <div class="seller-card">
              <div class="seller-card__banner seller-card__banner--home"></div>
              <div class="seller-card__content">
                <div class="seller-card__avatar">üåø</div>
                <h4 class="seller-card__name">{{ vendor }}</h4>
                <p class="seller-card__description">
                  {% if vendor_products.first.description != blank %}
                    {{ vendor_products.first.description | strip_html | truncate: 80 }}
                  {% else %}
                    Quality home and garden products
                  {% endif %}
                </p>
                <p class="seller-card__products">{{ vendor_products.size }} product{% if vendor_products.size != 1 %}s{% endif %}</p>
                <a href="/collections/all?filter.p.vendor={{ vendor | url_encode }}" class="seller-card__view-btn">View Products</a>
              </div>
            </div>
          {% endfor %}
        </div>
        {% if home_vendor_list.size > 3 %}
        <button class="seller-carousel__nav" onclick="scrollSellerCarousel('carousel-home')" aria-label="Next">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M9 18l6-6-6-6"/>
          </svg>
        </button>
        {% endif %}
      </div>
    </div>
    {% endif %}
  {% endif %}

  {% comment %} All Other Categories - Dynamic {% endcomment %}
  {% for collection in collections %}
    {% if collection.all_products_count > 0
        and collection.handle != 'frontpage'
        and collection.handle != 'all'
        and collection.handle != 'education-courses'
        and collection.handle != 'home-garden' %}

      {% assign cat_vendors = "" %}
      {% for product in collection.products %}
        {% unless cat_vendors contains product.vendor %}
          {% if cat_vendors != "" %}
            {% assign cat_vendors = cat_vendors | append: "||" %}
          {% endif %}
          {% assign cat_vendors = cat_vendors | append: product.vendor %}
        {% endunless %}
      {% endfor %}
      {% assign cat_vendor_list = cat_vendors | split: "||" %}

      {% if cat_vendor_list.size > 0 %}
      <div class="seller-carousel" data-category="{{ collection.handle }}">
        <div class="seller-carousel__header">
          <h3 class="seller-carousel__title">{{ collection.title }}</h3>
          <p class="seller-carousel__subtitle">{{ collection.description | strip_html | truncate: 60 }}</p>
        </div>
        <div class="seller-carousel__wrapper">
          <div class="seller-carousel__sellers" id="carousel-{{ collection.handle }}">
            {% for vendor in cat_vendor_list %}
              {% assign vendor_products = collection.products | where: "vendor", vendor %}
              <div class="seller-card">
                <div class="seller-card__banner"></div>
                <div class="seller-card__content">
                  <div class="seller-card__avatar">üõçÔ∏è</div>
                  <h4 class="seller-card__name">{{ vendor }}</h4>
                  <p class="seller-card__description">
                    {% if vendor_products.first.description != blank %}
                      {{ vendor_products.first.description | strip_html | truncate: 80 }}
                    {% else %}
                      Quality products from our community
                    {% endif %}
                  </p>
                  <p class="seller-card__products">{{ vendor_products.size }} product{% if vendor_products.size != 1 %}s{% endif %}</p>
                  <a href="/collections/all?filter.p.vendor={{ vendor | url_encode }}" class="seller-card__view-btn">View Products</a>
                </div>
              </div>
            {% endfor %}
          </div>
          {% if cat_vendor_list.size > 3 %}
          <button class="seller-carousel__nav" onclick="scrollSellerCarousel('carousel-{{ collection.handle }}')" aria-label="Next">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M9 18l6-6-6-6"/>
            </svg>
          </button>
          {% endif %}
        </div>
      </div>
      {% endif %}
    {% endif %}
  {% endfor %}

  <!-- Become a Seller CTA -->
  <div class="seller-cta">
    <h3 class="seller-cta__title">Want to become a seller?</h3>
    <p class="seller-cta__text">Join our community of devotee vendors and share your products or services.</p>
    <a href="/pages/become-a-seller" class="seller-cta__button">Become a Seller</a>
  </div>

</div>

<script>
  function scrollSellerCarousel(carouselId) {
    const carousel = document.getElementById(carouselId);
    if (carousel) {
      carousel.scrollBy({ left: 320, behavior: 'smooth' });
    }
  }

  function filterSellers() {
    const searchTerm = document.getElementById('sellerSearch').value.toLowerCase();
    const sellerCards = document.querySelectorAll('.seller-card');
    const carousels = document.querySelectorAll('.seller-carousel');

    sellerCards.forEach(card => {
      const name = card.querySelector('.seller-card__name').textContent.toLowerCase();
      const desc = card.querySelector('.seller-card__description').textContent.toLowerCase();
      if (name.includes(searchTerm) || desc.includes(searchTerm)) {
        card.style.display = '';
      } else {
        card.style.display = 'none';
      }
    });

    // Hide empty carousels
    carousels.forEach(carousel => {
      const visibleCards = carousel.querySelectorAll('.seller-card:not([style*="display: none"])');
      if (visibleCards.length === 0) {
        carousel.style.display = 'none';
      } else {
        carousel.style.display = '';
      }
    });
  }

  function filterBySellerCategory(category, btn) {
    const carousels = document.querySelectorAll('.seller-carousel');
    const filters = document.querySelectorAll('.seller-search-bar__filter');

    // Update active button
    filters.forEach(f => f.classList.remove('active'));
    btn.classList.add('active');

    // Show/hide carousels
    carousels.forEach(carousel => {
      if (category === 'all' || carousel.dataset.category === category) {
        carousel.style.display = '';
      } else {
        carousel.style.display = 'none';
      }
    });

    // Reset search and show all cards
    document.getElementById('sellerSearch').value = '';
    document.querySelectorAll('.seller-card').forEach(card => {
      card.style.display = '';
    });
  }
</script>

{% schema %}
{
  "name": "Seller Carousels",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Page Heading",
      "default": "Our Community Sellers"
    },
    {
      "type": "textarea",
      "id": "description",
      "label": "Page Description",
      "default": "Meet the trusted vendors from our temple community offering products and services with devotion and care."
    }
  ],
  "presets": [
    {
      "name": "Seller Carousels"
    }
  ]
}
{% endschema %}
